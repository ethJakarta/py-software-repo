<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Software Repository</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen p-8">
  <h1 class="text-4xl font-bold mb-8 text-center">💾 Software Repository</h1>

  <!-- 🔍 Search & Filter -->
  <div class="flex flex-col md:flex-row justify-center gap-4 mb-8">
    <input id="searchInput" type="text" placeholder="Cari software..."
           class="border border-gray-300 rounded-lg p-2 w-full md:w-1/3" />

    <select id="categoryFilter" class="border border-gray-300 rounded-lg p-2 w-full md:w-1/4">
      <option value="">Semua Kategori</option>
      {% for cat in categories %}
      <option value="{{ cat }}">{{ cat }}</option>
      {% endfor %}
    </select>
  </div>

  {% if softwares|length == 0 %}
    <p class="text-gray-600 text-center">Tidak ada software ditemukan.</p>
  {% else %}
  <div id="softwareGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for sw in softwares %}
      <div data-name="{{ sw.name|lower }}" data-category="{{ sw.category }}"
           class="software-card bg-white rounded-2xl shadow-md p-6 hover:shadow-lg transition">
        <img src="/static/default.png" class="w-16 h-16 mb-4 mx-auto" alt="icon">
        <h2 class="text-xl font-semibold text-gray-800 text-center">{{ sw.name }}</h2>
        <p class="text-sm text-gray-500 text-center mb-2">
          v{{ sw.version }} — {{ sw.category }}
        </p>
        <p class="text-gray-600 text-sm mb-4 text-center">{{ sw.description }}</p>
        <div class="flex justify-center">
          <a href="/download/{{ sw.relative_path }}" 
             class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700">
             Download
          </a>
        </div>
      </div>
    {% endfor %}
  </div>
  {% endif %}

  <script>
    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const cards = document.querySelectorAll('.software-card');

    function filterSoftware() {
      const keyword = searchInput.value.toLowerCase();
      const category = categoryFilter.value;

      cards.forEach(card => {
        const name = card.dataset.name;
        const cat = card.dataset.category;
        const match = (!keyword || name.includes(keyword)) &&
                      (!category || cat === category);
        card.style.display = match ? "block" : "none";
      });
    }

    searchInput.addEventListener('input', filterSoftware);
    categoryFilter.addEventListener('change', filterSoftware);
  </script>
</body>
</html>
